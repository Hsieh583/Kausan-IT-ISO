# ISO 27001 è‡ªå‹•åŒ–å·¥å…·ä½¿ç”¨æŒ‡å—

## ğŸ“– å¿«é€Ÿå…¥é–€æŒ‡å—

æœ¬æŒ‡å—å°‡å¹«åŠ©æ‚¨å¿«é€Ÿä¸Šæ‰‹ ISO 27001 è‡ªå‹•åŒ–è­‰æ“šç”Ÿæˆå·¥å…·ã€‚

## ğŸ”§ ç’°å¢ƒæº–å‚™

### 1. å®‰è£ Python

ç¢ºä¿å·²å®‰è£ Python 3.8 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼š

```bash
python --version
# Python 3.11.x æˆ–æ›´é«˜
```

### 2. å®‰è£ä¾è³´

```bash
cd scripts
pip install -r requirements.txt
```

## ğŸ“š åŸºæœ¬æŒ‡ä»¤

### æŒ‡ä»¤åˆ—è¡¨

```bash
# æŸ¥çœ‹å¹«åŠ©
python iso_automation.py --help

# æŸ¥çœ‹ç‰¹å®šæŒ‡ä»¤çš„å¹«åŠ©
python iso_automation.py list-templates --help
```

### 1. åˆ—å‡ºæ¨¡æ¿ (list-templates)

**æŸ¥çœ‹æ‰€æœ‰å¯ç”¨æ¨¡æ¿ï¼š**

```bash
python iso_automation.py list-templates
```

**æŸ¥çœ‹ç‰¹å®šé¡åˆ¥çš„æ¨¡æ¿ï¼š**

```bash
python iso_automation.py list-templates --category "å‚™ä»½èˆ‡å¾©åŸ"
python iso_automation.py list-templates --category "å¸³è™Ÿèˆ‡å­˜å–ç®¡ç†"
```

### 2. ç”Ÿæˆè­‰æ“šæ–‡ä»¶ (generate)

**åŸºæœ¬ç”¨æ³•ï¼ˆè‡ªå‹•æ­¸æª”ï¼‰ï¼š**

```bash
python iso_automation.py generate \
  --template "è¨˜éŒ„èˆ‡è­‰æ“š/å‚™ä»½èˆ‡å¾©åŸ/å‚™ä»½åŸ·è¡Œç´€éŒ„_Template.md" \
  --data examples/backup_data.json
```

æ­¤æŒ‡ä»¤æœƒè‡ªå‹•ï¼š
- è®€å–æ¨¡æ¿å’Œæ•¸æ“š
- ä½¿ç”¨ Jinja2 å¡«å……æ¨¡æ¿
- ç”Ÿæˆå¸¶æ™‚é–“æˆ³çš„æª”å
- æ­¸æª”è‡³ `è¨˜éŒ„èˆ‡è­‰æ“š/å‚™ä»½èˆ‡å¾©åŸ/2026/01/å‚™ä»½åŸ·è¡Œç´€éŒ„_20260124.md`

**æŒ‡å®šè¼¸å‡ºè·¯å¾‘ï¼š**

```bash
python iso_automation.py generate \
  --template "è¨˜éŒ„èˆ‡è­‰æ“š/å‚™ä»½èˆ‡å¾©åŸ/å‚™ä»½åŸ·è¡Œç´€éŒ„_Template.md" \
  --data examples/backup_data.json \
  --output /path/to/output.md \
  --no-archive
```

### 3. ç”Ÿæˆåˆè¦æ€§å ±å‘Š (compliance-report)

**è¼¸å‡ºåˆ°çµ‚ç«¯ï¼š**

```bash
python iso_automation.py compliance-report
```

**è¼¸å‡ºåˆ°æª”æ¡ˆï¼š**

```bash
python iso_automation.py compliance-report --output compliance_report.md
```

å ±å‘Šå…§å®¹åŒ…å«ï¼š
- è­‰æ“šé¡åˆ¥ç¸½æ•¸
- æ¨¡æ¿ç¸½æ•¸
- è­‰æ“šè¨˜éŒ„ç¸½æ•¸
- å„é¡åˆ¥è©³æƒ…
- ç¼ºå°‘è¨˜éŒ„çš„é¡åˆ¥å»ºè­°

### 4. ç”Ÿæˆé€±å ± (weekly-report)

**ç”ŸæˆæŒ‡å®šæœŸé–“çš„é€±å ±ï¼š**

```bash
python iso_automation.py weekly-report \
  --since 2026-01-17 \
  --until 2026-01-24 \
  --output weekly_report.md
```

**ç¯©é¸ç‰¹å®šä½œè€…ï¼š**

```bash
python iso_automation.py weekly-report \
  --since 2026-01-17 \
  --until 2026-01-24 \
  --author "å¼µä¸‰" \
  --output weekly_report.md
```

## ğŸ“ æº–å‚™æ•¸æ“šæª”æ¡ˆ

### JSON æ ¼å¼ç¯„ä¾‹

å»ºç«‹æª”æ¡ˆ `my_data.json`ï¼š

```json
{
  "å‚™ä»½ç®¡ç†å“¡": "å¼µä¸‰",
  "å‚™ä»½ç­–ç•¥": "å®Œæ•´+å¢é‡",
  "å‚™ä»½æ™‚é–“": "02:00",
  "æœ¬åœ°å‚™ä»½ä½ç½®": "\\\\fileserver\\backup\\",
  "ç•°åœ°å‚™ä»½ä½ç½®": "Backblaze B2 Cloud",
  "å‚™ä»½å°è±¡åˆ—è¡¨": [
    {
      "å°è±¡": "æª”æ¡ˆä¼ºæœå™¨",
      "é¡å‹": "å®Œæ•´",
      "é–‹å§‹æ™‚é–“": "02:00",
      "çµæŸæ™‚é–“": "03:30",
      "å¤§å°": "500",
      "è€—æ™‚": "90",
      "çµæœ": "æˆåŠŸ",
      "ç•°å¸¸ä¿¡æ¯": ""
    }
  ]
}
```

### YAML æ ¼å¼ç¯„ä¾‹

å»ºç«‹æª”æ¡ˆ `my_data.yaml`ï¼š

```yaml
å‚™ä»½ç®¡ç†å“¡: å¼µä¸‰
å‚™ä»½ç­–ç•¥: å®Œæ•´+å¢é‡
å‚™ä»½æ™‚é–“: "02:00"
æœ¬åœ°å‚™ä»½ä½ç½®: "\\\\fileserver\\backup\\"
ç•°åœ°å‚™ä»½ä½ç½®: Backblaze B2 Cloud
å‚™ä»½å°è±¡åˆ—è¡¨:
  - å°è±¡: æª”æ¡ˆä¼ºæœå™¨
    é¡å‹: å®Œæ•´
    é–‹å§‹æ™‚é–“: "02:00"
    çµæŸæ™‚é–“: "03:30"
    å¤§å°: "500"
    è€—æ™‚: "90"
    çµæœ: æˆåŠŸ
    ç•°å¸¸ä¿¡æ¯: ""
```

## ğŸ¨ ä½¿ç”¨ Jinja2 æ¨¡æ¿èªæ³•

### åŸºæœ¬è®Šæ•¸æ›¿æ›

```markdown
**å‚™ä»½ç®¡ç†å“¡**: {{ å‚™ä»½ç®¡ç†å“¡ }}
**æ—¥æœŸ**: {{ current_date }}
```

### æ¢ä»¶åˆ¤æ–·

```markdown
{% if ç•°å¸¸ä»¶æ•¸ == "0" %}
æ‰€æœ‰å‚™ä»½ä½œæ¥­å·²æˆåŠŸå®Œæˆã€‚
{% else %}
ç™¼ç¾ {{ ç•°å¸¸ä»¶æ•¸ }} å€‹ç•°å¸¸ã€‚
{% endif %}
```

### è¿´åœˆè™•ç†

```markdown
{% for å°è±¡ in å‚™ä»½å°è±¡åˆ—è¡¨ %}
- {{ å°è±¡.å°è±¡ }}: {{ å°è±¡.çµæœ }}
{% endfor %}
```

### è‡ªå‹•æä¾›çš„è®Šæ•¸

å·¥å…·è‡ªå‹•æä¾›ä»¥ä¸‹è®Šæ•¸ï¼š

- `current_date`: 2026å¹´01æœˆ24æ—¥
- `current_datetime`: 2026-01-24 14:30:00
- `current_year`: 2026
- `current_month`: 01
- `current_day`: 24

## ğŸš€ å¯¦éš›æ“ä½œç¯„ä¾‹

### ç¯„ä¾‹ 1: æ¯æ—¥å‚™ä»½è¨˜éŒ„ç”Ÿæˆ

**æ­¥é©Ÿ 1**: æº–å‚™æ•¸æ“šæª”æ¡ˆ `backup_daily.json`

```json
{
  "å‚™ä»½ç®¡ç†å“¡": "æå››",
  "å‚™ä»½ç­–ç•¥": "å®Œæ•´+å¢é‡",
  "å‚™ä»½æ™‚é–“": "02:00",
  "å‚™ä»½å°è±¡åˆ—è¡¨": [
    {
      "å°è±¡": "è³‡æ–™åº«",
      "é¡å‹": "å®Œæ•´",
      "çµæœ": "æˆåŠŸ"
    }
  ]
}
```

**æ­¥é©Ÿ 2**: åŸ·è¡Œç”ŸæˆæŒ‡ä»¤

```bash
python iso_automation.py generate \
  --template "è¨˜éŒ„èˆ‡è­‰æ“š/å‚™ä»½èˆ‡å¾©åŸ/å‚™ä»½åŸ·è¡Œç´€éŒ„_Template.md" \
  --data backup_daily.json
```

**çµæœ**: 
- è‡ªå‹•ç”Ÿæˆ `è¨˜éŒ„èˆ‡è­‰æ“š/å‚™ä»½èˆ‡å¾©åŸ/2026/01/å‚™ä»½åŸ·è¡Œç´€éŒ„_20260124.md`

### ç¯„ä¾‹ 2: é€±å ±è‡ªå‹•åŒ–

**å»ºç«‹é€±å ±ç”Ÿæˆè…³æœ¬** `generate_weekly_report.sh`ï¼š

```bash
#!/bin/bash

# è¨ˆç®—ä¸Šé€±æ—¥æœŸ
LAST_WEEK=$(date -d '7 days ago' +%Y-%m-%d)
TODAY=$(date +%Y-%m-%d)

# ç”Ÿæˆé€±å ±
python iso_automation.py weekly-report \
  --since "$LAST_WEEK" \
  --until "$TODAY" \
  --output "é€±å ±_${TODAY}.md"

echo "é€±å ±å·²ç”Ÿæˆ: é€±å ±_${TODAY}.md"
```

**åŸ·è¡Œï¼š**

```bash
chmod +x generate_weekly_report.sh
./generate_weekly_report.sh
```

### ç¯„ä¾‹ 3: å®šæœŸåˆè¦æ€§æª¢æŸ¥

**å»ºç«‹æª¢æŸ¥è…³æœ¬** `check_compliance.sh`ï¼š

```bash
#!/bin/bash

# ç”Ÿæˆåˆè¦æ€§å ±å‘Š
python iso_automation.py compliance-report \
  --output "åˆè¦å ±å‘Š_$(date +%Y%m%d).md"

# æª¢æŸ¥æ˜¯å¦æœ‰ç¼ºå°‘è¨˜éŒ„çš„é¡åˆ¥
if grep -q "âš ï¸" "åˆè¦å ±å‘Š_$(date +%Y%m%d).md"; then
  echo "è­¦å‘Š: ç™¼ç¾ç¼ºå°‘è¨˜éŒ„çš„é¡åˆ¥ï¼Œè«‹æŸ¥çœ‹å ±å‘Š"
  exit 1
else
  echo "åˆè¦æ€§æª¢æŸ¥é€šé"
  exit 0
fi
```

**è¨­ç½®å®šæœŸåŸ·è¡Œï¼ˆcrontabï¼‰ï¼š**

```bash
# æ¯é€±ä¸€æ—©ä¸Š 9:00 åŸ·è¡Œ
0 9 * * 1 /path/to/check_compliance.sh
```

## ğŸ”„ èˆ‡ CI/CD æ•´åˆ

### GitHub Actions

å·¥å…·å·²æ•´åˆ GitHub Actionsï¼Œæœƒåœ¨ä»¥ä¸‹æƒ…æ³è‡ªå‹•åŸ·è¡Œï¼š

- æ¯æ¬¡ Push åˆ°ä¸»åˆ†æ”¯
- æ¯é€±ä¸€å®šæœŸåŸ·è¡Œ
- æ‰‹å‹•è§¸ç™¼

æŸ¥çœ‹ `.github/workflows/verify-compliance.yml` äº†è§£è©³æƒ…ã€‚

### æœ¬åœ°æ‰‹å‹•è§¸ç™¼

å¦‚æœæ‚¨æƒ³åœ¨æœ¬åœ°æ¸¬è©¦ GitHub Actions å·¥ä½œæµç¨‹ï¼š

```bash
# å®‰è£ act (GitHub Actions æœ¬åœ°é‹è¡Œå·¥å…·)
brew install act  # macOS
# æˆ–
sudo apt install act  # Linux

# åŸ·è¡Œå·¥ä½œæµç¨‹
act -j compliance-check
```

## â“ å¸¸è¦‹å•é¡Œ

### Q1: åŸ·è¡Œæ™‚å‡ºç¾ "ModuleNotFoundError: No module named 'jinja2'"

**è§£æ±ºæ–¹æ¡ˆï¼š**
```bash
pip install -r requirements.txt
```

### Q2: ç”Ÿæˆçš„æª”æ¡ˆæ²’æœ‰å¡«å……æ•¸æ“š

**åŸå› **: æ¨¡æ¿å¯èƒ½æœªä½¿ç”¨ Jinja2 èªæ³•

**è§£æ±ºæ–¹æ¡ˆ**: ç¢ºä¿æ¨¡æ¿ä¸­ä½¿ç”¨äº†æ­£ç¢ºçš„ Jinja2 èªæ³•ï¼Œä¾‹å¦‚ `{{ è®Šæ•¸å }}`

### Q3: æ‰¾ä¸åˆ°æ¨¡æ¿æª”æ¡ˆ

**ç¢ºèªæ¨¡æ¿è·¯å¾‘ï¼š**
```bash
python iso_automation.py list-templates
```

### Q4: Git Commit è¨˜éŒ„ç‚ºç©º

**ç¢ºèª Git è¨­ç½®ï¼š**
```bash
git log --since="2026-01-01"
```

å¦‚æœæ²’æœ‰è¨˜éŒ„ï¼Œæª¢æŸ¥æ—¥æœŸç¯„åœæˆ– Git å€‰åº«ç‹€æ…‹ã€‚

## ğŸ“ å–å¾—å”åŠ©

å¦‚æœé‡åˆ°å•é¡Œï¼š

1. æŸ¥çœ‹ README.md
2. ä½¿ç”¨ `--help` æŸ¥çœ‹æŒ‡ä»¤èªªæ˜
3. æŸ¥çœ‹ç¯„ä¾‹æª”æ¡ˆ (`scripts/examples/`)
4. æäº¤ Issue åˆ° GitHub

## ğŸ“š å»¶ä¼¸é–±è®€

- [Jinja2 æ¨¡æ¿èªæ³•å®˜æ–¹æ–‡æª”](https://jinja.palletsprojects.com/)
- [ISO 27001 æ¨™æº–èªªæ˜](../P0.%20ISO%2027001%20æ–‡ä»¶èˆ‡è¨˜éŒ„é«”ç³»èªªæ˜ï¼ˆæ²»ç†èˆ‡ç”¢å‡ºæŒ‡å°ç‰ˆï¼‰.md)
- [è¨˜éŒ„ç³»çµ±ç›®éŒ„æŒ‡å—](../è¨˜éŒ„èˆ‡è­‰æ“š/è¨˜éŒ„ç³»çµ±ç›®éŒ„æŒ‡å—.md)

---

**æœ€å¾Œæ›´æ–°**: 2026-01-24
